# -*- coding: utf-8 -*-
"""
Created on Sun Nov 22 20:32:01 2020

@author: vmpsk
"""

import pygame 
import numpy as np
import math  
import sys

pygame.init()

screen = pygame.display.set_mode((600,600))

#Title and icon
pygame.display.set_caption("Hello world")
#icon = pygame.image.load('RedCircle.png')
#pygame.display.set_icon(icon)
font = pygame.font.Font('freesansbold.ttf', 20)

# Import image of the body in the game
circleImage = pygame.image.load('RedCircle.png')
circlePosition = np.array([80.0, 15.0]) # [x, y]
circleVelocity = np.array([0.05, 0.0]) # [Vx, Vy]
accelaration = np.array([0.0, .001])# [Ax, Ay]


def showHeight():
    height = font.render("h = " + str(round(circlePosition[1],2)) + "; v =" + str(round(circleVelocity[1],2)), True, (0,0,0))
    screen.blit(height,(300,10))

def circleShow(x,y):
    screen.blit(circleImage, (x,y))

running = True
drop = False
bounce = False
action = False

# Game loop
while running:
    screen.fill((255,255,255)) # Fills the back ground of the screen with color
    # QUIT pygame application and windows
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False
            pygame.display.quit()
            pygame.quit()
#            sys.exit()
            exit()  ## not necessary as it restarts the console
        
        if not(action):
            if event.type == pygame.KEYDOWN:
                if event.key == pygame.K_DOWN:
                    action = True
                    drop = True

    if drop:
        circleVelocity[1] = circleVelocity[1] + accelaration[1]
        circlePosition[1] = circlePosition[1] + circleVelocity[1]
        circlePosition[0] = circlePosition[0] + circleVelocity[0]
        

    if bounce:
        circleVelocity[1] = circleVelocity[1] - accelaration[1]
        circlePosition[1] = circlePosition[1] - circleVelocity[1]
        circlePosition[0] = circlePosition[0] + circleVelocity[0]
        


    if circlePosition[1] >= 520 and drop == True:
        drop = False
        bounce = True
        circleVelocity = 0.9*circleVelocity
        circlePosition[1] = 520

    if circleVelocity[1]<=0.001 and action == True:
        drop = True
        bounce = False

    if circleVelocity[1] <= 0.001 and (circlePosition[1] >= 520 and drop == True):
        drop = False
        bounce = False
    else:
        circleShow(circlePosition[0], circlePosition[1]) #(x,y)
        showHeight()
        pygame.display.update()
        print(circleVelocity, circlePosition)
